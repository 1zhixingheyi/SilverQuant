# SilverQuant 快速开始指南

## 前置准备

### 系统要求
- Windows 10及以上
- 64位操作系统
- 稳定的网络连接
- 8GB以上内存推荐

### 必需软件下载

#### Python环境
- Python 3.10.11推荐版本
- 下载地址: https://www.python.org/downloads/release/python-31010/
- 安装时勾选Add to PATH

#### PyCharm IDE
- 社区版Community即可
- 下载地址: https://www.jetbrains.com/pycharm/download/?section=windows
- 免费开源

#### GitHub Desktop
- 代码管理工具
- 下载地址: https://desktop.github.com/
- 图形化操作

#### QMT交易客户端
- 联系券商客户经理开通
- 支持QMT的券商列表: https://www.bilibili.com/opus/1014402646051651589
- 下载对应券商版本

#### Node.js
- v16及以上版本
- 下载地址: https://nodejs.org/zh-cn
- 问财选股必需

#### 掘金3客户端(模拟盘)
- 模拟盘测试用
- 下载地址: https://www.myquant.cn/terminal
- 免费注册使用

## 环境搭建

### 克隆项目
- 使用GitHub Desktop克隆
- 或命令行: `gh repo clone silver6wings/SilverQuant`
- 国内镜像: https://gitee.com/silver6wings/silverQuant

### 打开项目
- 启动PyCharm
- File > Open
- 选择SilverQuant文件夹

### 配置Python环境
- PyCharm自动检测Python
- 或手动添加Python 3.10解释器
- 创建虚拟环境venv

### 安装依赖包
```bash
# 打开PyCharm终端(Terminal)
# 确认看到(venv)前缀

# 基础安装
pip install -r requirements.txt

# 如果速度慢,使用国内镜像
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple/

# 补充安装mootdx(如果需要)
pip install mootdx>=0.11.7
```

### 配置凭证文件
```bash
# 1. 复制模板文件
复制 credentials_sample.py 为 credentials.py

# 2. 编辑credentials.py,填入以下信息:
```

```python
# QMT账户配置
QMT_ACCOUNT_ID = '你的账户ID'  # 咨询券商
QMT_CLIENT_PATH = r'C:\QMT安装路径\userdata_mini'  # 实际安装路径

# 钉钉通知配置(可选)
DING_SECRET = 'SEC开头的加签密钥'
DING_TOKENS = 'https://oapi.dingtalk.com/robot/send?access_token=...'

# 掘金模拟盘配置(模拟盘必需)
GM_CLIENT_TOKEN = '掘金客户端的Token'
GM_ACCOUNT_ID = '模拟账户ID'
```

## 申请第三方服务

### 申请钉钉机器人(可选)

#### 创建钉钉群
- 至少拉3人创建普通群
- 群名称: 量化交易通知群

#### 添加机器人
- 群设置 > 机器人
- 添加机器人 > 自定义机器人
- 机器人名称: 交易播报

#### 获取密钥
- 安全设置选择: 加签
- 复制SEC开头的密钥 → DING_SECRET
- 复制Webhook地址 → DING_TOKENS
- 勾选同意条款,完成

### 申请掘金模拟盘(测试必需)

#### 注册账户
- 打开掘金3客户端
- 手机号注册新账户
- 登录客户端

#### 获取Token
- 系统设置 > 密钥管理(Token)
- 复制Token → GM_CLIENT_TOKEN

#### 创建模拟账户
- 账户管理 > 添加仿真账户
- 设置模拟入金金额(建议100万)
- 设置模拟交易费率(万2.5)
- 复制账户ID → GM_ACCOUNT_ID

## 首次运行

### 启动QMT客户端
- 勾选"极简模式"或"独立交易"
- 确认左下角数据源连接正常
- 保持客户端运行状态

### 运行测试策略
```python
# 1. 打开 run_wencai_qmt.py

# 2. 找到配置行(第24行附近)
IS_PROD = False     # False=模拟盘, True=实盘
IS_DEBUG = True     # 开启调试信息

# 3. 确认策略参数
class BuyConf:
    time_ranges = [['14:47', '14:57']]  # 尾盘买入
    interval = 30                        # 30秒扫描一次
    slot_count = 5                       # 最多持仓5只
    slot_capacity = 10000                # 每只最多1万元

class SellConf:
    risk_limit = 1 - 0.03               # 3%止损
    earn_limit = 9.999                  # 接近涨停止盈

# 4. 点击绿色运行按钮▶
```

### 查看运行状态
```bash
# 控制台输出
正在启动 问财选股[测]...
Loading codes and names...Complete!
生成临时 session_id: 1234567890
正在建立交易连接...返回值:0...成功!
正在订阅主推回调...返回值:0...成功!
连接完毕。

# 盘中输出
[09:30].........
[09:31]..........
```

## 验证功能

### 检查选股功能
```python
# 在selector/select_wencai.py中测试
python selector/select_wencai.py

# 应该能看到选股结果
Wencai: 09:35:42
   股票代码  股票简称  curr_price
0  000001   平安银行    12.34
1  000002   万科A      15.67
...
```

### 检查数据缓存
```bash
# 运行一段时间后,检查缓存目录
_cache/test_pwc/
├── held_days.json      # 持仓天数
├── max_price.json      # 历史最高价
├── deal_hist.csv       # 交易记录
└── assets.csv          # 资金曲线
```

### 检查钉钉通知
- 查看钉钉群是否收到消息
- [测]账号**1234:刷新XXX支
- [MB]市买 000001 平安银行...

## 模拟盘测试

### 测试周期
- 至少运行1个月
- 跨越不同市场环境
- 记录每日表现

### 观察指标
- 每日交易次数
- 平均持仓天数
- 胜率(盈利单/总单)
- 盈亏比(平均盈利/平均亏损)
- 最大回撤

### 参数调优
```python
# 根据测试结果调整参数

# 如果交易太频繁
slot_count = 3              # 减少持仓数
interval = 60               # 增加扫描间隔

# 如果止损太频繁
risk_limit = 1 - 0.05      # 放宽止损线到5%

# 如果盈利不够
fall_from_top = [
    (1.10, 9.99, 0.02),    # 涨10%以上,回落2%卖
    (1.05, 1.10, 0.05),    # 涨5-10%,回落5%卖
]
```

### 记录优化日志
```markdown
## 2025-01-15 参数调整
- 止损从3%放宽到5%
- 原因: 3%止损过于频繁,很多正常波动被止损
- 预期: 降低止损次数,提高持仓稳定性

## 2025-01-20 效果观察
- 止损次数从15次降到8次
- 盈利订单从5单增加到10单
- 继续观察一周
```

## 轻仓实盘

### 切换实盘模式
```python
# 编辑 run_wencai_qmt.py
IS_PROD = True      # ⚠️ 开启实盘交易
IS_DEBUG = False    # 关闭调试信息(可选)

# 修改缓存路径(自动切换)
PATH_BASE = CACHE_PROD_PATH  # 使用prod_pwc目录
```

### 保守配置
```python
# 首次实盘建议配置
class BuyConf:
    slot_count = 3          # 最多持仓3只
    slot_capacity = 5000    # 每只最多5000元

class SellConf:
    risk_limit = 0.97       # 3%严格止损
    earn_limit = 1.15       # 15%止盈(保守)
```

### 实盘前检查清单
- [ ] QMT客户端已启动
- [ ] 数据源连接正常
- [ ] 账户有足够资金(至少2万)
- [ ] IS_PROD已改为True
- [ ] 策略参数已调整
- [ ] 钉钉通知已配置
- [ ] 缓存目录已创建
- [ ] 盘前测试运行正常

### 实盘监控
```bash
# 盘中检查项
- 每30分钟看一次运行状态
- 确认委托正常执行
- 观察钉钉通知
- 查看持仓情况

# 盘后复盘
- 查看_cache/prod_pwc/deal_hist.csv
- 统计当日交易
- 分析盈亏原因
- 记录优化思路
```

## 常见问题

### QMT连接失败
```
问题: 返回值:-1...失败!
原因: QMT客户端未启动
解决:
1. 启动QMT客户端
2. 勾选极简模式
3. 确认数据源连接
4. 重启Python脚本
```

### Node.js未找到
```
问题: 'NoneType' object has no attribute 'get'
原因: Node.js未安装或未重启IDE
解决:
1. 安装Node.js
2. 重启PyCharm(重要!)
3. 重启电脑(如果还不行)
```

### 问财选股报错
```
问题: 查询失败或无结果
原因:
1. 网络问题
2. 问句不合法
3. 查询频率过高

解决:
1. 先在 https://www.iwencai.com/ 测试问句
2. 增加interval到60秒
3. 检查网络连接
```

### 依赖包安装失败
```
问题: pip install 报错
解决:
# 升级pip
python -m pip install --upgrade pip

# 使用国内镜像
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple/

# 单独安装失败的包
pip install akshare --upgrade
```

## 下一步

### 学习策略开发
- 阅读 02-核心模块详解.md
- 理解买卖点逻辑
- 学习卖出策略组合

### 自定义策略
- 修改选股Prompt
- 调整卖出参数
- 创建新的Seller组件

### 进阶功能
- 远程推票服务
- 自定义技术指标
- 多账户管理

### 加入社区
- GitHub Issues交流
- Star项目支持作者
- 提交改进PR

## 重要提醒

### 三遍箴言
- 先轻仓模拟
- 先轻仓模拟
- 先轻仓模拟

### 风险警示
- 量化交易有风险
- 策略需充分测试
- 不要盲目满仓
- 严格止损纪律
- 亏损自行承担

### 联系作者
- 带着Star和GitHub ID
- 添加微信: junchaoyu_
- 加入技术交流群
- 谨防假冒收费